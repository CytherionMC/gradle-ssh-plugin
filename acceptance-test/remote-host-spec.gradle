remotes {
    yetAnotherLocalhost {
        role 'testServers'
        host = 'localhost'
        user = System.getProperty('user.name')
        identity = file("${System.getProperty('user.home')}/.ssh/id_rsa")
    }
}


task('should execute the command on multiple remotes specified by brace list') << {
    def x = randomInt()
    def y = randomInt()
    assert ssh.run {
        session([remotes.localhost, remotes.yetAnotherLocalhost]) {
            execute "expr $x + $y"
        }
    } as int == (x + y)
}

task('should execute the command on multiple remotes specified by arguments') << {
    def x = randomInt()
    def y = randomInt()
    assert ssh.run {
        session(remotes.localhost, remotes.yetAnotherLocalhost) {
            execute "expr $x + $y"
        }
    } as int == (x + y)
}

task('should execute the command on multiple remotes specified by the role') << {
    def x = randomInt()
    def y = randomInt()
    assert ssh.run {
        session(remotes.role('testServers')) {
            execute "expr $x + $y"
        }
    } as int == (x + y)
}
